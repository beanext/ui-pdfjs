"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="bui.pdf"),function(a,b){b(angular)}(this,function(a){"use strict";function b(a){var b=a.indexOf("#"),c=a.indexOf("?"),d=Math.min(b>0?b:a.length,c>0?c:a.length);return a.substring(a.lastIndexOf("/",d)+1,d)}function c(a){var b=document.createElement("a");return b.href=a,b.host||(b.href=b.href),b}function d(b){return{templateUrl:"src/viewer/pdfjs/viewer.html",restrict:"E",scope:{onInit:"&",onPageLoad:"&",scale:"=",enableOpenFile:"=",enableDownload:"=",enablePrint:"=",enableFullscreen:"=",enableBookmark:"=",enableFirstPage:"=",enableLastPage:"=",enableRotateL:"=",enableRotateR:"=",enableHandTool:"=",enableDocProps:"=",enableScale:"=",enableZoomOut:"=",enableZoomIn:"=",numPagesVisible:"=",enableNumPage:"=",enablePageDown:"=",enablePageUp:"=",enableSidebar:"=",enableSearch:"=",width:"=",height:"="},link:function(c,d,e){function f(){if(g=!0,"true"===e.removeMouseListeners){window.removeEventListener("DOMMouseScroll",handleMouseWheel),window.removeEventListener("mousewheel",handleMouseWheel);var b=document.querySelectorAll(".page");a.forEach(b,function(b){a.element(b).children().css("pointer-events","none")})}c.onInit&&c.onInit()}d.children().wrap('<div class="pdfjs" style="width: 100%; height: 100%;"></div>'),c.outerContainerStyle="",void 0!==c.width&&(c.outerContainerStyle+="width:"+c.width),void 0!==c.height&&(c.outerContainerStyle+="height:"+c.height),c.secondaryToolbarToggleVisible=c.enableFirstPage||c.enableLastPage||c.enableRotateL||c.enableRotateR||c.enableHandTool||c.enableDocProps,c.secondaryToolbarSeparators=[],c.secondaryToolbarSeparators.push((c.enableFirstPage||c.enableLastPage)&&(c.enableRotateL||c.enableRotateR||c.enableHandTool||c.enableDocProps)),c.secondaryToolbarSeparators.push((c.enableRotateL||c.enableRotateR)&&(c.enableHandTool||c.enableDocProps)),c.secondaryToolbarSeparators.push(c.enableHandTool&&c.enableDocProps),console.log(c.secondaryToolbarSeparators);var g=!1,h={},i=0,j=b(function(){var b=PDFViewerApplication.pdfViewer;b?c.scale!==b.currentScale&&(h={},i=0,c.scale=b.currentScale):console.warn("PDFViewerApplication.pdfViewer is not set");var d=document.querySelectorAll(".page");a.forEach(d,function(b){var d=a.element(b),e=d.data("page-number");return d.data("loaded")?void(e in h||(g||f(),c.onPageLoad&&c.onPageLoad({page:e})===!1||(h[e]=!0,i++))):void delete h[e]})},200);d.on("$destroy",function(){b.cancel(j)}),c.$watch(function(){return e.src},function(){e.src&&PDFJS.webViewerLoad(e.src)})}}}var e={};e.scripts=document.querySelectorAll("script[src]"),e.path=e.scripts[e.scripts.length-1].src,e.filename=b(e.path),e.folder=c(e.path).pathname.replace(e.filename,""),d.$inject=["$interval"];var f=a.module("bui.pdf",[]).directive("buiPdf",d);f.provider("pdfjsViewerConfig",function(){var a={workerSrc:null,cmapDir:null,imageResourcesPath:null,disableWorker:!1};this.setWorkerSrc=function(b){a.workerSrc=b},this.setCmapDir=function(b){a.cmapDir=b},this.setImageDir=function(b){a.imageDir=b},this.disableWorker=function(b){"undefined"==typeof b&&(b=!0),a.disableWorker=b},this.$get=function(){return a}}),f.run(["pdfjsViewerConfig",function(a){a.workerSrc&&(PDFJS.workerSrc=a.workerSrc),a.cmapDir&&(PDFJS.cMapUrl=a.cmapDir),a.imageDir&&(PDFJS.imageResourcesPath=a.imageDir),a.disableWorker&&(PDFJS.disableWorker=!0)}])});